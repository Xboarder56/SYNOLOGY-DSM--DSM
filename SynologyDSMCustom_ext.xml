<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ns2:device-extension xmlns:ns2="event_parsing/device_extension">
    <pattern type="JavaPattern" id="EventCategory-Pattern-1">\w+\s+\d+\s+[\d:]+\s\S+\s(\w+)(?:\:|\s)</pattern>
    <pattern type="JavaPattern" id="EventName-Pattern-1">Connection:\s(\w+)\s\[.*?\]\s\w+\s\[.*?\]\s(?:via\s\[.*?\]|)(accessed\s\w+\s\w+|failed\s\w+\s\w+\s\w+|logged\s\w+\s\w+)</pattern>
    <pattern type="JavaPattern" id="EventName-Pattern-2">System\s\w+:\s(?:The\s|)(The\sUPS|Normal\s\w+\s\w+|app\sprivilege|IP\saddress|External\sdisk|external\sdevice|Metadata\s\w+\s\w+\s\w+|VPN\sprofile|\S+|)\s(?:\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\]\sand\ssubnet\smask\s\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\]\swere\s|on\sapp\s\[.*?\]\sfor\s\w+\s\[.*?\]\s|\[.*?\]\s|\w+\s\w+\s\[.*?\]\s|)(.*?)(?:|\son\s\[.*?\]|\sfrom\s\[.*?\]|\sfolder\s\[.*?|\sto\s\[.*?\.\w+\]|)\.</pattern>
    <pattern type="JavaPattern" id="EventName-Pattern-3">\w+(?:\sEvent\:\s|\:\sSYSTEM\:\s)(Last\smessage|\w+)(?:.*?File\/Folder\:|\s'.*?'\s\w+\s\d+\s\w+,)\s(\w+)</pattern>
    <pattern type="JavaPattern" id="DeviceTime-Pattern-1">(\w+)\s+(\d+)\s+([\d:]+)\s</pattern>
    <pattern type="JavaPattern" id="SourceIp-Pattern-1">(?:from|on|IP:)\s(?:|\[)(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})</pattern>
    <pattern type="JavaPattern" id="UserName-Pattern-1">(?:System|user|User|User:)\s(?:|\[)(\w+|\w+|\w+)(?:\:|,|\])</pattern>
    <pattern type="JavaPattern" id="AllEvents">(.*?)</pattern>
    <match-group device-type-id-override="4004" order="1">
        <matcher order="1" enable-substitutions="true" capture-group="\1" pattern-id="EventCategory-Pattern-1" field="EventCategory"/>
        <matcher order="1" enable-substitutions="true" capture-group="\1 \2" pattern-id="EventName-Pattern-1" field="EventName"/>
        <matcher order="2" enable-substitutions="true" capture-group="\1 \2" pattern-id="EventName-Pattern-2" field="EventName"/>
        <matcher order="3" enable-substitutions="true" capture-group="\1 \2" pattern-id="EventName-Pattern-3" field="EventName"/>
        <matcher ext-data="yyyy-MMM-dd hh:mm:ss" order="1" enable-substitutions="true" capture-group="2018-\1-\2 \3" pattern-id="DeviceTime-Pattern-1" field="DeviceTime"/>
        <matcher order="1" enable-substitutions="true" capture-group="\1" pattern-id="SourceIp-Pattern-1" field="SourceIp"/>
        <matcher order="1" enable-substitutions="true" capture-group="\1" pattern-id="UserName-Pattern-1" field="UserName"/>
        <event-match-multiple force-qidmap-lookup-on-fixup="true" send-identity="UseDSMResults" pattern-id="AllEvents"/>
    </match-group>
</ns2:device-extension>
